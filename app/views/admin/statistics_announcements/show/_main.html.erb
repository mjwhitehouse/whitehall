<p class="govuk-body-lead">
  <%= @statistics_announcement.summary %>
</p>

<div class="govuk-!-padding-bottom-6">
  <%=
    render "govuk_publishing_components/components/summary_list", {
      borderless: true,
      items: [
        { field: "Type", value: @statistics_announcement.display_type },
        { field: "Organisations", value: @statistics_announcement.organisations.map(&:name).to_sentence },
      ],
    }
  %>
</div>

<div>
  <%= render "components/inset_prompt", {
    error: true,
    description: "Statistics release cancelled - #{@statistics_announcement.cancellation_reason}.",
  } if @statistics_announcement.cancelled? %>
</div>

<div class="govuk-body govuk-!-padding-bottom-4">
  <%= render "govuk_publishing_components/components/heading", {
    text: "Release and delivery date",
    heading_level: 2,
    font_size: "l",
    margin_bottom: 3,
  } %>
  <p>
    <%= link_to("Change dates",
                new_admin_statistics_announcement_change_path(@statistics_announcement),
                class: "govuk-link",
                data: {
                  module: "gem-track-click",
                  "track-category": "button-clicked",
                  "track-action": "#{@statistics_announcement.model_name.singular.dasherize}-button",
                  "track-label": "Change dates",
                }) %>
  </p>
  <%= render "govuk_publishing_components/components/heading", {
    text: "Release date",
    heading_level: 3,
    font_size: "m",
    margin_bottom: 2,
  } %>
  <p> <%= @statistics_announcement.release_date.to_fs(:date_with_time) %> </p>
  <%= render "govuk_publishing_components/components/heading", {
    text: "Delivery date",
    heading_level: 3,
    font_size: "m",
    margin_bottom: 2,
  } %>
  <p>
    <span><%= @statistics_announcement.display_date %></span>
    <span>(<%= @statistics_announcement.confirmed? ? 'confirmed' : 'provisional' %>)</span>
  </p>
</div>

<div class="govuk-body govuk-!-padding-bottom-4">
  <%= render "govuk_publishing_components/components/heading", {
    text: "Connected document",
    heading_level: 2,
    font_size: "l",
    margin_bottom: 3,
  } %>
  <p>
    <% if @statistics_announcement.publication %>
      <%= link_to("Change connected document",
                  admin_statistics_announcement_publication_index_path(@statistics_announcement),
                  class: "govuk-link ,govuk-!-margin-bottom-8") %>
      <table class="govuk-table">
        <tr>
          <td><%= @statistics_announcement.publication.title %></td>
          <td><%= link_to("View",
                          admin_statistics_announcement_publication_index_path(@statistics_announcement),
                          class: "govuk-link") %></td>
        </tr>
      </table>
    <% else %>
      <span><%= link_to("Add existing document",
                        admin_statistics_announcement_publication_index_path(@statistics_announcement),
                        class: "govuk-link") %></span>
      <span> or </span>
      <span><%= link_to("create new document",
                        new_admin_publication_path(statistics_announcement_id: @statistics_announcement),
                        class: "govuk-link") %></span>
    <% end %>
  </p>
</div>

<div class="govuk-body">
  <%= render "govuk_publishing_components/components/heading", {
    text: "Topic taxonomy tags",
    heading_level: 2,
    font_size: "l",
    margin_bottom: 3,
  } %>
  <p>
    <%= link_to( @edition_taxons.any? ? "Change tags" : "Add tags",
                edit_admin_statistics_announcement_tags_path(@statistics_announcement.id),
                class: "govuk-link") %>
  </p>
  <% if @edition_taxons.any? %>
    <%= render "govuk_publishing_components/components/list", {
      extra_spacing: true,
      items: @edition_taxons.map do |taxon|
        render("govuk_publishing_components/components/breadcrumbs", {
          collapse_on_mobile: true,
          breadcrumbs: taxon.full_path
        })
      end
    } %>
  <% else %>
    <p>No tags selected</p>
  <% end %>
</div>
